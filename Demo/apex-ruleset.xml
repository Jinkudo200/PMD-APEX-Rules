<?xml version="1.0" encoding="UTF-8"?>
<ruleset name="Custom Apex Ruleset"
         xmlns="http://pmd.sourceforge.net/ruleset/2.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://pmd.sourceforge.net/ruleset/2.0.0 https://pmd.github.io/pmd-7.17.0/ruleset_xml_schema.xsd">

    <description>
        Salesforce Apex ruleset with custom security rules (Hardcoded secrets)
    </description>


    <!-- ========================== -->
    <!-- 1. Hardcoded Secrets & Named Credentials -->
    <!-- ========================== -->
    <rule name="Hardcoded-Secrets-And-Named-Credentials-Rule"
          language="apex"
          class="rules.HardcodedSecretsAndNamedCredentialsRule"
          message="Hardcoded secret, API key, password, or token found.">
        <priority>2</priority>
    </rule>

    <!-- ========================== -->
    <!-- 2. Sensitive Logging & Monitoring -->
    <!-- ========================== -->
    <rule name="Sensitive-Logging-And-Monitoring-Enhanced-Rule"
          language="apex"
          class="rules.SensitiveLoggingAndMonitoringEnhancedRule"
          message="Sensitive data or PII logged in debug output.">
        <priority>2</priority>
    </rule>

    <!-- ========================== -->
    <!-- 3. Insecure Deserialization -->
    <!-- ========================== -->
    <rule name="Insecure-Deserialization-Enhanced-Rule"
          language="apex"
          class="rules.InsecureDeserializationEnhancedRule"
          message="Unsafe deserialization of untrusted input detected.">
        <priority>2</priority>
    </rule>

    <!-- ========================== -->
    <!-- 4. Weak Authentication & Sharing -->
    <!-- ========================== -->
    <rule name="Weak-Auth-And-Sharing-Rule"
          language="apex"
          class="rules.WeakAuthAndSharingRule"
          message="Class or method allows insecure sharing or weak authentication.">
        <priority>2</priority>
    </rule>

    <!-- ========================== -->
    <!-- 5. SOQL Injection -->
    <!-- ========================== -->
    <rule name="SOQL-Injection-Taint-Rule"
          language="apex"
          class="rules.SoqlInjectionTaintRule"
          message="Potential SOQL injection detected. Validate or escape input.">
        <priority>1</priority>
    </rule>

    <!-- ========================== -->
    <!-- 6. Command Injection & Schedule -->
    <!-- ========================== -->
    <rule name="Command-Injection-And-Schedule-Rule"
          language="apex"
          class="rules.CommandInjectionAndScheduleRule"
          message="Unsafe command execution or scheduled job with untrusted input detected.">
        <priority>2</priority>
    </rule>


</ruleset>
